You are an expert full-stack developer tasked with building the "Maskan Breakfast Management" app in Replit, a kitchen management system for multi-floor residential settings (e.g., apartments or dorms). Use Python with Flask (backend), HTML/CSS/JS (frontend), and SQLite (DB) for local data persistence. Ensure security (role-based access), responsiveness (mobile/desktop), and optimization to avoid lag or crashes with efficient DB queries, error handling, and minimal DOM updates. Use Bootstrap for UI styling and Font Awesome for icons. The app must be primarily offline, with network usage limited to login/logout and receiving notifications, and must implement WhatsApp-like offline functionality with data refresh when connected.
Login Page Design and Behavior

Layout: A centered card with a teal (#26A69A) background, white text, and rounded edges. Include a role selection dropdown (options: Admin, Pantry Head, Tea Manager, Member) with a "Sign In" button (teal, 3D, fa-lock icon). Remove all "invite code" fields and logic.

Admin: On first login or app reboot, use fixed username "Administrator" and password "administrator" (applicable only to Admin account). After first login, Admin can change the password.
Pantry Head, Tea Manager, Member: Display "Email" field (validated against DB for that role) and "Password" field (default "maskanmarol" unless changed). Add a "Verify Email" button next to the email field. Upon successful email verification (POST to /verify-email), redirect to a "Create Username and Password" tab with fields for username, password, and confirmation, saving to DB and redirecting to the dashboard.


Behavior:

Admin logs in with initial "Administrator"/"administrator" or updated credentials.
Other roles verify email, create username/password, then log in. POST to /login with hashed passwords (Werkzeug).
No self-registration; only Admin can create accounts. Persistent login (sessions), last page return (localStorage), logout with fa-unlock button.


Validation: Real-time checks for email existence, password match, and email verification status; error modal on failure.

Dashboard Design and Options

Layout: A fixed top navigation bar with tabs (Home, People, Calendar, Menus, Tea, Expenses, Suggestions, Feedbacks, Requests, Procurement, Profile, Admin), teal background, white text, hover effects, and a responsive dropdown on mobile. Below, a main content area with a card-based layout, displaying role-specific options.
Options:

Home: Quick stats (user count, pending requests, weekly expenses in INR), profile avatar, dark/light toggle, "Refresh" button, "Download App" icon (fa-download with tooltip).
People: View/edit user list (Admin only).
Calendar: Interactive grid for menus/assignments.
Menus: Add/edit menus (Admin, Pantry Heads), view-only for others.
Tea: Schedule/assign tea tasks (Tea Manager), view-only for others.
Expenses: Manage expenses (Admin, Pantry Heads), view-only for others.
Suggestions: Submit/view suggestions (all).
Feedbacks: Submit/view feedbacks (all, Admin moderates).
Requests: Submit/approve absences (Members, Admin).
Procurement: Manage shopping lists (Admin, Pantry Heads).
Profile: View/edit personal data.
Admin: Manage users/roles/settings.



Role Definitions and Specifications

Admin (1 per floor):

Access: Full access to all tabs (Home, People, Calendar, Menus, Tea, Expenses, Suggestions, Feedbacks, Requests, Procurement, Profile, Admin) with full edit rights on all functionalities.
Specifications: Manages all users, roles, and settings. Initial login uses username "Administrator" and password "administrator" (on first login or app reboot, applicable only to Admin). The Admin Dashboard includes buttons to "Add Members," "Add Pantry Heads," and "Add Tea Managers," opening a modal with an "Email" field. Submission (POST to /add-user) stores email with role (member, pantryHead, teaManager) and default password "maskanmarol" in DB. Can set/edit floor (1-11) for other roles, view/edit all data, and manage analytics.


Pantry Heads (2 per floor):

Access: Edit rights on Menus, Expenses, and Procurement tabs; view-only access to Home, People, Calendar, Tea, Suggestions, Feedbacks, Requests, and Profile tabs.
Specifications: Manage menu creation/editing (with "Assigned to" dropdown), expense tracking (with dropdown filter and printable letter), and procurement assignments. Floor (1-11) is editable by Admin, and they cannot manage users or create accounts.


Tea Manager (1 per floor):

Access: Edit rights on the Tea tab; view-only access to Home, People, Calendar, Menus, Expenses, Suggestions, Feedbacks, Requests, Procurement, and Profile tabs.
Specifications: Handles tea scheduling/assignments exclusively. Floor (1-11) is editable by Admin, and they cannot manage users or other data.


Member (unlimited):

Access: View-only access to Home, People, Calendar, Menus, Tea, Expenses, Suggestions, Feedbacks, Requests, and Procurement tabs; edit rights only in Profile tab for personal data; submit rights for Suggestions, Feedbacks, and Requests.
Specifications: Can rate/comment, submit requests/absences, and view content. No edit or management rights, with floor assigned by Admin.



Tab Specifications (Based on Image Context)

Assume a tabbed interface with icons: Home (fa-home), People (fa-users), Calendar (fa-calendar), Menus (fa-utensils), Tea (fa-coffee), Expenses (fa-money-bill), Suggestions (fa-lightbulb), Feedbacks (fa-comment), Requests (fa-bell), Procurement (fa-shopping-cart), Profile (fa-user), Admin (fa-cog).
Each tab loads content in a card layout, with teal borders and animated transitions.

Additional Features and Updates

Offline Storage: Use SQLite and IndexedDB/localStorage for all data, with a local queue for unsynced changes.
Server Sync: Sync queue during login/logout, using compression and batch updates.
Notifications: Notification API with service worker for 2-day cooking alerts to assigned users.
Data Refresh: Background sync on connection, with conflict resolution (timestamp-based).
Calendar Fix: Fix HTTP 500 error, display menus for all roles offline.
Refresh Button: Near toggle, reloads offline data.
Assigned to Dropdown: In Menus tab, Admin/Pantry Heads assign cooks.
Download App Icon: Near toggle, prompts static HTML/JS download.
Expenses Dropdown: Filter by date/user/category.
Printable Letter: Collapsible card with floor name, itemized expenses, total in INR.
Floor Editability: Admin sets floor (1-11) for Pantry Heads/Tea Managers, propagates to all.
Tea Manager Login: Teal button with fa-coffee icon.

Changes

Change 1: Remove Invite Code & Add Admin-Only Add Options

Remove all "invite code" fields and logic from the login page and Admin account. Add "Add Members," "Add Pantry Heads," and "Add Tea Managers" buttons in Admin Dashboard, opening a modal with an "Email" field. POST to /add-user, store email with role and default password "maskanmarol".


Change 2: Modify Login Behavior

Role-based login with email/password (default "maskanmarol" for Pantry Heads, Tea Managers, Members), Admin uses initial "Administrator"/"administrator". Add "Verify Email" for other roles, redirecting to "Create Username and Password" tab post-verification.



Implementation Details

Setup: requirements.txt (Flask, Werkzeug, sqlite3, Chart.js). Install via pip, 32/64-bit compatible.
Build: DB models (roles enum), routes/templates (login with verification, "Create Username and Password" tab, dashboard, tabs), JS for offline/sync/validation.
UI: Bootstrap, teal accents, responsive cards.
Testing: Verify login with initial Admin credentials, email verification for other roles, "Create Username and Password" redirection, admin add options, offline mode, tab functionality, data sync.

Generate the complete code, ensuring all features and changes are implemented.