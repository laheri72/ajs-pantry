{% extends "base.html" %}

{% block title %}Staff Login - Maskan Breakfast Management{% endblock %}

{% block content %}
<div class="login-container">
    <div class="login-card shadow-lg animate-fade-in">
        <div class="card-header bg-teal text-white text-center py-5 position-relative">
            <div class="login-logo mb-3">
                <i class="fas fa-user-shield fa-3x shadow-sm p-3 rounded-circle bg-white text-teal"></i>
            </div>
            <h2 class="fw-bold mb-0 mt-2">Staff Login</h2>
            <p class="small opacity-75 mb-0 mt-1">Management Portal</p>
            <div class="header-shape"></div>
        </div>

        <div class="card-body p-4 p-md-5">
            <form method="POST" class="needs-validation" novalidate>
                <div class="mb-4">
                    <label class="form-label small fw-bold text-uppercase tracking-wider text-muted" for="role">
                        <i class="fas fa-id-badge me-1"></i> Access Level
                    </label>
                    <div class="input-group">
                        <span class="input-group-text bg-light border-end-0"><i
                                class="fas fa-users-cog text-teal-light"></i></span>
                        <select class="form-select bg-light border-start-0 ps-0" name="role" id="role"
                            onchange="toggleInputs()">
                            <option value="pantryHead">Pantry Head</option>
                            <option value="teaManager">Tea Manager</option>
                            <option value="admin">System Admin</option>
                        </select>
                    </div>
                </div>

                <div class="mb-4" id="emailInput">
                    <label class="form-label small fw-bold text-uppercase tracking-wider text-muted" for="email">
                        <i class="fas fa-id-card me-1"></i> TR Number
                    </label>
                    <div class="input-group">
                        <span class="input-group-text bg-light border-end-0"><i
                                class="fas fa-user text-teal-light"></i></span>
                        <input class="form-control bg-light border-start-0 ps-0" id="email" name="email" type="text"
                            placeholder="e.g. 25687" />
                        <span
                            class="input-group-text bg-white border-start-0 small text-muted">@jameasaifiyah.edu</span>
                    </div>
                </div>

                <div class="mb-4 d-none" id="usernameInput">
                    <label class="form-label small fw-bold text-uppercase tracking-wider text-muted" for="username">
                        <i class="fas fa-user me-1"></i> Admin Username
                    </label>
                    <div class="input-group">
                        <span class="input-group-text bg-light border-end-0"><i
                                class="fas fa-user-tag text-teal-light"></i></span>
                        <input class="form-control bg-light border-start-0 ps-0" id="username" name="username"
                            type="text" placeholder="your username" />
                    </div>
                </div>

                <div class="mb-4">
                    <label class="form-label small fw-bold text-uppercase tracking-wider text-muted mb-1"
                        for="password">
                        <i class="fas fa-lock me-1"></i> Password
                    </label>
                    <div class="input-group">
                        <span class="input-group-text bg-light border-end-0"><i
                                class="fas fa-key text-teal-light"></i></span>
                        <input class="form-control bg-light border-start-0 ps-0" id="password" name="password"
                            type="password" placeholder="Enter your password" required />
                        <button class="btn btn-outline-light border bg-light text-muted border-start-0" type="button"
                            id="togglePassword">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>

                <div class="mb-0 mt-5">
                    <button type="submit" class="btn btn-teal w-100 py-3 fw-bold shadow-sm hover-scale">
                        Access Dashboard <i class="fas fa-shield-alt ms-2"></i>
                    </button>
                </div>
            </form>
        </div>

        <div class="card-footer bg-light border-0 text-center py-4">
            <div class="pt-2">
                <span class="small text-muted">Member?</span>
                <a href="{{ url_for('login') }}" class="small fw-bold text-teal text-decoration-none hover-link">
                    Member Login <i class="fas fa-arrow-right ms-1"></i>
                </a>
            </div>
        </div>
    </div>
</div>

<style>
    .login-container {
        min-height: calc(100vh - 120px);
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, var(--teal-primary) 0%, var(--teal-dark) 100%);
        padding: 40px 20px;
        position: relative;
        overflow: hidden;
    }

    /* Hide navigation elements for focused login */
    .navbar {
        display: none !important;
    }

    .main-content {
        margin-top: 0 !important;
        padding: 0 !important;
    }

    /* .footer { display: block !important; } */

    .login-card {
        width: 100%;
        max-width: 450px;
        background: white;
        border-radius: 20px;
        overflow: hidden;
        border: none;
        z-index: 10;
    }

    .bg-teal {
        background-color: var(--teal-primary) !important;
    }

    .text-teal {
        color: var(--teal-primary) !important;
    }

    .text-teal-light {
        color: var(--teal-light) !important;
    }

    .header-shape {
        position: absolute;
        bottom: -1px;
        left: 0;
        width: 100%;
        height: 40px;
        background: white;
        clip-path: ellipse(60% 100% at 50% 100%);
    }

    .input-group-text {
        border-color: #eee;
    }

    .form-control,
    .form-select {
        border-color: #eee;
    }

    .form-control:focus,
    .form-select:focus {
        border-color: var(--teal-primary);
        box-shadow: none;
        background-color: white !important;
    }

    .tracking-wider {
        letter-spacing: 0.05em;
    }

    .animate-fade-in {
        animation: fadeInScale 0.6s ease-out forwards;
    }

    @keyframes fadeInScale {
        from {
            opacity: 0;
            transform: scale(0.95) translateY(10px);
        }

        to {
            opacity: 1;
            transform: scale(1) translateY(0);
        }
    }

    .hover-link:hover {
        text-decoration: underline !important;
        color: var(--teal-dark) !important;
    }

    #togglePassword {
        cursor: pointer;
    }
</style>

<script>
    function toggleInputs() {
        const role = document.getElementById('role').value;
        const emailInput = document.getElementById('emailInput');
        const usernameInput = document.getElementById('usernameInput');
        const emailField = document.getElementById('email');
        const usernameField = document.getElementById('username');

        if (role === 'admin') {
            emailInput.classList.add('d-none');
            usernameInput.classList.remove('d-none');
            emailField.required = false;
            emailField.disabled = true;
            emailField.value = '';
            usernameField.required = true;
            usernameField.disabled = false;
        } else {
            emailInput.classList.remove('d-none');
            usernameInput.classList.add('d-none');
            emailField.required = true;
            emailField.disabled = false;
            usernameField.required = false;
            usernameField.disabled = true;
            usernameField.value = '';
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        toggleInputs();

        const togglePassword = document.querySelector('#togglePassword');
        const password = document.querySelector('#password');

        if (togglePassword && password) {
            togglePassword.addEventListener('click', function (e) {
                const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
                password.setAttribute('type', type);
                this.querySelector('i').classList.toggle('fa-eye');
                this.querySelector('i').classList.toggle('fa-eye-slash');
            });
        }
    });
</script>
{% endblock %}